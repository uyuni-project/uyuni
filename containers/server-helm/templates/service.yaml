apiVersion: v1
kind: Service
metadata:
  labels:
    app: uyuni
  name: uyuni-tcp
  namespace: "{{ .Release.Namespace }}"
{{- if .Values.servicesAnnotations }}
  annotations:
{{ toYaml .Values.servicesAnnotations | indent 4 }}
{{- end }}
spec:
  ports:
  - name: http
    port: 80
    protocol: TCP
    targetPort: 80
  - name: salt-publish
    port: 4505
    protocol: TCP
    targetPort: 4505
  - name: salt-request
    port: 4506
    protocol: TCP
    targetPort: 4506
  - name: cobbler
    port: 25151
    protocol: TCP
    targetPort: 25151
  - name: postgresql
    port: 5432
    protocol: TCP
    targetPort: 5432
  - name: monitoring
    port: 9800
    protocol: TCP
    targetPort: 9800
{{- if .Values.exposeJavaDebug | default false }}
  - name: tomcat-debug
    port: 8000
    protocol: TCP
    targetPort: 8000
  - name: tasko-debug
    port: 8001
    protocol: TCP
    targetPort: 8001
{{- end }}
  selector:
    app: uyuni
  type: ClusterIP
---
apiVersion: v1
kind: Service
metadata:
  labels:
    app: uyuni
  name: uyuni-udp
  namespace: "{{ .Release.Namespace }}"
{{- if .Values.servicesAnnotations }}
  annotations:
{{ toYaml .Values.servicesAnnotations | indent 4 }}
{{- end }}
spec:
  ports:
  - name: tftp
    port: 69
    protocol: UDP
    targetPort: 69
  selector:
    app: uyuni
  type: ClusterIP
