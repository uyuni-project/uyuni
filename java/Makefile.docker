# Makefile
#

# Docker tests variables
DOCKER_CONTAINER_BASE = suma-3.1
DOCKER_REGISTRY       = registry.mgr.suse.de
DOCKER_VOLUMES        = -v "$(CURDIR)/../:/manager"
DOCKER_PG_PORTS       = -p 5432:5432

all :: dockerrun_pg

dockerpull ::
	docker pull $(DOCKER_REGISTRY)/$(DOCKER_CONTAINER_BASE)-pgsql-4eclipse

dockerrun_pg ::
	cp buildconf/test/rhn.conf.postgresql-example buildconf/test/rhn.conf
	docker run $(DOCKER_PG_PORTS) $(DOCKER_VOLUMES) $(DOCKER_REGISTRY)/$(DOCKER_CONTAINER_BASE)-pgsql-4eclipse

dockerrun_ora ::
	cp buildconf/test/rhn.conf.oracle-example buildconf/test/rhn.conf
	docker run --privileged -t -i $(DOCKER_VOLUMES) $(DOCKER_REGISTRY)/$(DOCKER_CONTAINER_BASE)-ora-4eclipse /root/docker-oracle-db4eclipse.sh
